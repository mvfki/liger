<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Doublet detection with DoubletFinder — runDoubletFinder • rliger2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Doublet detection with DoubletFinder — runDoubletFinder"><meta property="og:description" content='Detect doublet with DoubletFinder. Package "Seurat" and
"DoubletFinder" would be required to run this function. "DoubletFinder" can
only be installed via
GitHub.
Seurat default PCA workflow is performed prior to calling DoubletFinder.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rliger2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Integrating_multi_scRNA_data.html">Integrating multiple scRNAseq data</a>
    </li>
    <li>
      <a href="../articles/Integrating_scRNA_and_scATAC_data.html">Integrating scRNA and scATAC data</a>
    </li>
    <li>
      <a href="../articles/online_iNMF_tutorial.html">Online iNMF with HDF5 based data</a>
    </li>
    <li>
      <a href="../articles/UINMF_vignette.html">Integration using unshared features</a>
    </li>
    <li>
      <a href="../articles/cross_species_vig.html">Cross-species Analysis with UINMF</a>
    </li>
    <li>
      <a href="../articles/STARmap_dropviz_vig.html">UINMF with STARmap spatial and transcriptomic</a>
    </li>
    <li>
      <a href="../articles/SNAREseq_walkthrough.html">UINMF with SNAREseq scATAC and scRNA</a>
    </li>
    <li>
      <a href="../articles/rna_methylation.html">Integrating scRNAseq and DNA methylation</a>
    </li>
    <li>
      <a href="../articles/Parameter_selection.html">Parameter selection</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Usage
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/import_data.html">Import data</a>
    </li>
    <li>
      <a href="../articles/liger_object.html">Introduction to a liger object</a>
    </li>
    <li>
      <a href="../articles/liger_with_seurat.html">Interoperate with Seurat</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">NEWS</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/welch-lab/liger" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Doublet detection with DoubletFinder</h1>
    <small class="dont-index">Source: <a href="https://github.com/welch-lab/liger/blob/HEAD/R/DoubletFinder.R" class="external-link"><code>R/DoubletFinder.R</code></a></small>
    <div class="hidden name"><code>runDoubletFinder.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Detect doublet with DoubletFinder. Package "Seurat" and
"DoubletFinder" would be required to run this function. "DoubletFinder" can
only be installed via
<a href="https://github.com/chris-mcginnis-ucsf/DoubletFinder" class="external-link">GitHub</a>.</p>
<p>Seurat default PCA workflow is performed prior to calling DoubletFinder.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">runDoubletFinder</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  useDatasets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nPCs <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nNeighbors <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  nExp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"ligerVerbose"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>A <a href="liger-class.html">liger</a> object.</p></dd>


<dt>useDatasets</dt>
<dd><p>A character vector of the names, a numeric or logical
vector of the index of the datasets to run
<code>doubletFinder_v3</code> with. Default <code>NULL</code>
applies to all datasets.</p></dd>


<dt>nPCs</dt>
<dd><p>Number of top PC to use. Default <code>10</code>.</p></dd>


<dt>nNeighbors</dt>
<dd><p>Number of the PC neighborhood size used to compute pANN.
See "See Also". Scalar for all used datasets or vector for each. Default
<code>20</code>.</p></dd>


<dt>nExp</dt>
<dd><p>The total number of doublet predictions produced. Scalar for all
used datasets or vector for each. Default <code>NULL</code> sets a 0.15 proportion.</p></dd>


<dt>verbose</dt>
<dd><p>Logical. Whether to show information of the progress. Default
<code>getOption("ligerVerbose")</code> which is <code>TRUE</code> if users have not set.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to
<code>doubletFinder_v3</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Updated <code>object</code> with variables <code>DoubletFinder_pANN</code> and
<code>DoubletFinder_classification</code> updated in <code>cellMeta</code> slot</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>doubletFinder_v3</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu">runDoubletFinder</span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `cellMeta&lt;-`(`*tmp*`, "DoubletFinder_pANN", value = NA):</span> Length of value does not match with cell index.</span>
<span class="r-in"><span><span class="fu"><a href="liger-class.html">cellMeta</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 600 rows and 7 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        dataset               barcode      nUMI     nGene</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;factor&gt;           &lt;character&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AAACATACCTCGCT.1     ctrl ctrl_AAACATACCTCGCT.1      2151       102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AAACGGCTCTTCGC.1     ctrl ctrl_AAACGGCTCTTCGC.1      1916       103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AACACTCTAAGTAG.1     ctrl ctrl_AACACTCTAAGTAG.1      1869        95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AACCGCCTCAGGAG.1     ctrl ctrl_AACCGCCTCAGGAG.1       733        84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AACGTTCTTCCGTC.1     ctrl ctrl_AACGTTCTTCCGTC.1       573        76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                        ...                   ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTCATGACTTATCC.1     stim stim_TTCATGACTTATCC.1      1091       101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTCATGACTTCAGG.1     stim stim_TTCATGACTTCAGG.1       431        86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTCGGAGATTTCAC.1     stim stim_TTCGGAGATTTCAC.1      1344       102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTGACACTTCCTGC.1     stim stim_TTGACACTTCCTGC.1      1423       105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTTGCATGAACGAA.1     stim stim_TTTGCATGAACGAA.1      2818       120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            mito      ribo      hemo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AAACATACCTCGCT.1         0  10.83217         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AAACGGCTCTTCGC.1         0  20.25052         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AACACTCTAAGTAG.1         0   5.08293         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AACCGCCTCAGGAG.1         0  42.70123         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ctrl_AACGTTCTTCCGTC.1         0  38.04538         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                         ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTCATGACTTATCC.1         0   8.61595         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTCATGACTTCAGG.1         0  41.29930         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTCGGAGATTTCAC.1         0   8.85417         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTGACACTTCCTGC.1         0  11.94659         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stim_TTTGCATGAACGAA.1         0   9.43932         0</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joshua Welch, Yichen Wang, Chao Gao, Jialin Liu, Joshua Sodicoff, Velina Kozareva, Evan Macosko.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

