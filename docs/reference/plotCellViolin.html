<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function allows for using available cell metadata, feature
expression or factor loading to generate violin plot, and grouping the data
with available categorical cell metadata. Available categorical cell metadata
can be used to form the color annotation. When it is different from the
grouping, it forms a nested grouping. Multiple y-axis variables are allowed
from the same specification of slot, and this returns a list of violin
plot for each. Users can further split the plot(s) by grouping on cells (e.g.
datasets)."><title>Generate violin/box plot(s) using liger object — plotCellViolin • rliger</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.8/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Generate violin/box plot(s) using liger object — plotCellViolin"><meta property="og:description" content="This function allows for using available cell metadata, feature
expression or factor loading to generate violin plot, and grouping the data
with available categorical cell metadata. Available categorical cell metadata
can be used to form the color annotation. When it is different from the
grouping, it forms a nested grouping. Multiple y-axis variables are allowed
from the same specification of slot, and this returns a list of violin
plot for each. Users can further split the plot(s) by grouping on cells (e.g.
datasets)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rliger</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/installation.html">Installation</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/Integrating_multi_scRNA_data.html">Integrating multiple scRNAseq data</a>
    <a class="dropdown-item" href="../articles/Integrating_scRNA_and_scATAC_data.html">Integrating scRNA and scATAC data</a>
    <a class="dropdown-item" href="../articles/online_iNMF_tutorial.html">Online iNMF with HDF5 based data</a>
    <a class="dropdown-item" href="../articles/UINMF_vignette.html">Integration using unshared features</a>
    <a class="dropdown-item" href="../articles/cross_species_vig.html">Cross-species Analysis with UINMF</a>
    <a class="dropdown-item" href="../articles/STARmap_dropviz_vig.html">UINMF with STARmap spatial and transcriptomic</a>
    <a class="dropdown-item" href="../articles/SNAREseq_walkthrough.html">UINMF with SNAREseq scATAC and scRNA</a>
    <a class="dropdown-item" href="../articles/rna_methylation.html">Integrating scRNAseq and DNA methylation</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-usage">Usage</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-usage">
    <a class="dropdown-item" href="../articles/import_data.html">Import data</a>
    <a class="dropdown-item" href="../articles/liger_object.html">Introduction to a liger object</a>
    <a class="dropdown-item" href="../articles/liger_with_seurat.html">Interoperate with Seurat</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">NEWS</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://welch-lab.github.io/">Welch Lab</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/welch-lab/liger">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/LabWelch">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generate violin/box plot(s) using liger object</h1>
      <small class="dont-index">Source: <a href="https://github.com/welch-lab/liger/blob/HEAD/R/ggplotting.R" class="external-link"><code>R/ggplotting.R</code></a></small>
      <div class="d-none name"><code>plotCellViolin.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows for using available cell metadata, feature
expression or factor loading to generate violin plot, and grouping the data
with available categorical cell metadata. Available categorical cell metadata
can be used to form the color annotation. When it is different from the
grouping, it forms a nested grouping. Multiple y-axis variables are allowed
from the same specification of <code>slot</code>, and this returns a list of violin
plot for each. Users can further split the plot(s) by grouping on cells (e.g.
datasets).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotCellViolin</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  groupBy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  slot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cellMeta"</span>, <span class="st">"rawData"</span>, <span class="st">"normData"</span>, <span class="st">"scaleData"</span>, <span class="st">"H.norm"</span>, <span class="st">"H"</span><span class="op">)</span>,</span>
<span>  yFunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cellIdx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colorBy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  splitBy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  titles <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><a href="liger-class.html">liger</a> object</p></dd>


<dt>y</dt>
<dd><p>Available variable name in <code>slot</code> to look for the value to
visualize.</p></dd>


<dt>groupBy, colorBy</dt>
<dd><p>Available variable name in <code>cellMeta</code> slot to
look for categorical grouping. See details. Default <code>NULL</code> produces no
grouping and all-black graphic elements.</p></dd>


<dt>slot</dt>
<dd><p>Choose the slot to find the <code>y</code> variable. See Details.
Default <code>"cellMeta"</code>.</p></dd>


<dt>yFunc</dt>
<dd><p>A function object that expects a vector/factor/data.frame
retrieved by <code>y</code> as the only input, and returns an object of the same
size, so that the y-axis is replaced by this output. Useful when, for
example, users need to scale the gene expression shown on plot.</p></dd>


<dt>cellIdx</dt>
<dd><p>Character, logical or numeric index that can subscribe cells.
Missing or <code>NULL</code> for all cells.</p></dd>


<dt>splitBy</dt>
<dd><p>Character vector of categorical variable names in
<code>cellMeta</code> slot. Split all cells by groupings on this/these variable(s)
to produce a violin plot containing only the cells in each group. Default
<code>NULL</code>.</p></dd>


<dt>titles</dt>
<dd><p>Title text. A character scalar or a character vector with as
many elements as multiple plots are supposed to be generated. Default
<code>NULL</code>.</p></dd>


<dt>...</dt>
<dd><p>More plot setting arguments. See <code><a href="dot-ggCellViolin.html">.ggCellViolin</a></code> and
<code><a href="dot-ggplotLigerTheme.html">.ggplotLigerTheme</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A ggplot object when a single plot is intended. A list of ggplot
objects, when multiple <code>y</code> variables and/or <code>splitBy</code> are set. When
<code>plotly = TRUE</code>, all ggplot objects become plotly (htmlwidget) objects.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Available option for <code>slot</code> include: <code>"cellMeta"</code>,
<code>"rawData"</code>, <code>"normData"</code>, <code>"scaleData"</code>, <code>"H.norm"</code>
and <code>"H"</code>. When <code>"rawData"</code>, <code>"normData"</code> or
<code>"scaleData"</code>, <code>y</code> has to be a character vector of feature names.
When <code>"H.norm"</code> or <code>"H"</code>, <code>colorBy</code> can be any valid index to
select one factor of interests. Note that character index follows
<code>"Factor_[k]"</code> format, with replacing <code>[k]</code> with an integer.</p>
<p>When <code>"cellMeta"</code>, <code>y</code> has to be an available column name in
the table. Note that, for <code>y</code> as well as <code>groupBy</code>, <code>colorBy</code>
and <code>splitBy</code> since a matrix object is feasible in <code>cellMeta</code>
table, using a column (e.g. named as <code>"column1"</code> in a certain matrix
(e.g. named as <code>"matrixVar"</code>) should follow the syntax of
<code>"matrixVar.column1"</code>. When the matrix does not have a "colname"
attribute, the subscription goes with <code>"matrixVar.V1"</code>,
<code>"matrixVar.V2"</code> and etc. These are based on the nature of
<code>as.data.frame</code> method on a <code><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></code> object.</p>
<p><code>groupBy</code> is basically send to <code>ggplot2::aes(x)</code>, while
<code>colorBy</code> is for the "colour" aesthetics. Specifying <code>colorBy</code>
without <code>groupBy</code> visually creates grouping but there will not be
varying values on the x-axis, so <code>boxWidth</code> will be forced to the same
value as <code>violinWidth</code> under this situation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">plotCellViolin</span><span class="op">(</span><span class="va">pbmcPlot</span>, y <span class="op">=</span> <span class="st">"nUMI"</span>, groupBy <span class="op">=</span> <span class="st">"dataset"</span>, slot <span class="op">=</span> <span class="st">"cellMeta"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotCellViolin-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotCellViolin</span><span class="op">(</span><span class="va">pbmcPlot</span>, y <span class="op">=</span> <span class="st">"nUMI"</span>, groupBy <span class="op">=</span> <span class="st">"leiden_cluster"</span>,</span></span>
<span class="r-in"><span>               slot <span class="op">=</span> <span class="st">"cellMeta"</span>, splitBy <span class="op">=</span> <span class="st">"dataset"</span>,</span></span>
<span class="r-in"><span>               colorBy <span class="op">=</span> <span class="st">"leiden_cluster"</span>,</span></span>
<span class="r-in"><span>               box <span class="op">=</span> <span class="cn">TRUE</span>, dot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               ylab <span class="op">=</span> <span class="st">"Total counts per cell"</span>,</span></span>
<span class="r-in"><span>               colorValues <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Set1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nUMI.ctrl</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Duplicated `override.aes` is ignored.</span>
<span class="r-plt img"><img src="plotCellViolin-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nUMI.stim</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Duplicated `override.aes` is ignored.</span>
<span class="r-plt img"><img src="plotCellViolin-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">plotCellViolin</span><span class="op">(</span><span class="va">pbmcPlot</span>, y <span class="op">=</span> <span class="st">"S100A8"</span>, slot <span class="op">=</span> <span class="st">"normData"</span>,</span></span>
<span class="r-in"><span>               yFunc <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">*</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               groupBy <span class="op">=</span> <span class="st">"dataset"</span>, colorBy <span class="op">=</span> <span class="st">"leiden_cluster"</span>,</span></span>
<span class="r-in"><span>               box <span class="op">=</span> <span class="cn">TRUE</span>, ylab <span class="op">=</span> <span class="st">"S100A8 Expression"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Duplicated `override.aes` is ignored.</span>
<span class="r-plt img"><img src="plotCellViolin-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Joshua Welch, Yichen Wang, Chao Gao, Jialin Liu, Joshua Sodicoff, Velina Kozareva, Evan Macosko.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

